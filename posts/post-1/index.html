<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><title>Editorial: [CF] 258E | Blog</title><meta name=description content="A simple and concise hugo theme."><link rel=stylesheet href=https://kaplanbar.github.io/css/simpleness.css><link rel=canonical href=https://kaplanbar.github.io/posts/post-1/><link rel=alternate type=application/rss+xml href title=Blog><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous></link><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body class=container><nav class=navigation><div class=nav-left><div class="nav-item nav-title"><a href=https://kaplanbar.github.io/>Blog</a></div><div class="nav-item nav-menu"><a href=/>Home</a>
<a href=/about/>About</a></div></div><div class="nav-item nav-right fontawesome"><a href=https://github.com/kaplanbar target=_blank><i title=GitHub class="fab fa-github"></i></a>
<a href=https://kaplanbar.github.io/index.xml target=_blank><i title=RSS class="fas fa-rss"></i></a></div></nav><article class=post><header class=post-header><h1 style=text-align:center>Editorial: [CF] 258E</h1><div class=post-metadata><time datetime=2021-06-27T00:00:00Z>June 27, 2021</time> &nbsp;
<i class="far fa-clock"></i>
2 min
26 s
&nbsp;
<i class="fas fa-folder"></i>
<a href=/categories/empty>empty</a>
&nbsp;</div></header><div class=post-text><p>I will share a solution to the problem <a href=https://codeforces.com/contest/451/problem/E>CF 258E.</a></p><h2 id=short-statement>Short statement</h2><p>You are given \(n\) boxes where \(i\)-th box contains \(f_i\) flowers. All flowers in a box are same color (indistinguishable) and there are no two flowers in the different boxes that have the same color.</p><p>We want to select exactly \(s\) flowers from those boxes. Find out how many different ways to select in modulo \(10^9 + 7\).</p><p>\(n \leq 20\), \(f_i \leq 10^{12}\) and \(s \leq 10^{14}\).</p><h2 id=solution>Solution</h2><p>Let \(x_i\) be the number of flowers taken from the \(i\)-th box. Then, we will have the following equation:</p><p>$$
x_1 + x_2 + x_3 + \dots + x_n = s,
$$</p><p>where \(0 \leq x_i \leq f_i\).</p><p>Assume that we did not have the constraint on \(f_i\). Then we could calculate answer as \(\binom{s + n - 1}{n - 1}\).</p><p>Since we have constraint on the maximum number of flowers we can take from the \(i\)-th box, the equation above contains cases where we took more than we could from some boxes. We can reach the answer by subtracting such cases.</p><p>Assume that we took more flowers than we can for the boxes \(b_i \in B \). Then the number ways we have counted where we took more flowers than we can will be equal to \(\binom{(s - \sum (f_{b_i} + 1)) + n - 1}{n - 1}\). We can think this formula as we preserved \( f_{b_i} + 1 \) flowers for the \(i\)-th box so that it is guaranteed to exceed \(f_i\).</p><p>Using that formula, we can calculate the number of cases where we took more flowers than we could and subtract it from the total number of cases.</p><p>You can find the C++ code for the solution described above.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> mod <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e9</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>    ll s;
</span></span><span style=display:flex><span>    cin <span style=color:#f92672>&gt;&gt;</span> n <span style=color:#f92672>&gt;&gt;</span> s;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;</span> v(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) cin <span style=color:#f92672>&gt;&gt;</span> v[i];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> fast_pw <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](ll x, ll y) <span style=color:#f92672>-&gt;</span> ll {
</span></span><span style=display:flex><span>        ll ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(;y;y<span style=color:#f92672>&gt;&gt;=</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(y<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span>) ret <span style=color:#f92672>=</span> (ret <span style=color:#f92672>*</span> x) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>            x <span style=color:#f92672>=</span> (x <span style=color:#f92672>*</span> x) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ret;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> inv(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;=</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        inv[i] <span style=color:#f92672>=</span> fast_pw(i, mod <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> comb <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](ll x, <span style=color:#66d9ef>int</span> y) <span style=color:#f92672>-&gt;</span> ll {
</span></span><span style=display:flex><span>        assert(x <span style=color:#f92672>&gt;=</span> y);
</span></span><span style=display:flex><span>        ll ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> y; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            ret <span style=color:#f92672>=</span> (ret <span style=color:#f92672>*</span> ((x <span style=color:#f92672>-</span> i) <span style=color:#f92672>%</span> mod)) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>            ret <span style=color:#f92672>=</span> (ret <span style=color:#f92672>*</span> inv[i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ret;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ll ans <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> n); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        ll cur <span style=color:#f92672>=</span> s;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(i <span style=color:#f92672>&gt;&gt;</span> j <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                cur <span style=color:#f92672>-=</span> v[j] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                c<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(cur <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(cur <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(c <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) ans <span style=color:#f92672>=</span> (ans <span style=color:#f92672>-</span> comb(cur <span style=color:#f92672>+</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> mod) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> ans <span style=color:#f92672>=</span> (ans <span style=color:#f92672>+</span> comb(cur <span style=color:#f92672>+</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>%</span> mod;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    cout <span style=color:#f92672>&lt;&lt;</span> ans;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><div class=post-tags><i class="fas fa-tags"></i>
<a href=/tags/empty>empty</a>
&nbsp;</div></footer><div class=comments><div class=comments></div></div></article><div class=foot>&copy; 2021 - 2024 &#183;
<a href=/>Blog</a> &#183;
Theme <a href=https://github.com/RainerChiang/simpleness>Simpleness</a> Powered by <a href=https://gohugo.io/>Hugo</a> &#183;
<a href=#><i class="fas fa-chevron-up"></i></a></div></body><script src=/js/lazyload.min.js></script>
<script>var lazyImage=new LazyLoad({container:document.getElementById("article")})</script></html>